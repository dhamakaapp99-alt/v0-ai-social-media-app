{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/robin/OneDrive/Desktop/colorcode/v0-ai-social-media-app/lib/auth.js"],"sourcesContent":["import { SignJWT, jwtVerify } from \"jose\"\r\nimport { cookies } from \"next/headers\"\r\nimport bcrypt from \"bcryptjs\"\r\n\r\nconst secret = new TextEncoder().encode(process.env.JWT_SECRET || \"colorcode-secret-key-2024\")\r\n\r\nexport async function hashPassword(password) {\r\n  return bcrypt.hash(password, 12)\r\n}\r\n\r\nexport async function verifyPassword(password, hashedPassword) {\r\n  return bcrypt.compare(password, hashedPassword)\r\n}\r\n\r\nexport async function createToken(payload) {\r\n  return new SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setExpirationTime(\"7d\").sign(secret)\r\n}\r\n\r\nexport async function verifyToken(token) {\r\n  try {\r\n    const { payload } = await jwtVerify(token, secret)\r\n    return payload\r\n  } catch {\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getSession() {\r\n  const cookieStore = await cookies()\r\n  const token = cookieStore.get(\"auth-token\")?.value\r\n  if (!token) return null\r\n  return verifyToken(token)\r\n}\r\n\r\nexport async function setSession(userId, email) {\r\n  const token = await createToken({ userId, email })\r\n  const cookieStore = await cookies()\r\n  cookieStore.set(\"auth-token\", token, {\r\n    httpOnly: true,\r\n    secure: process.env.NODE_ENV === \"production\",\r\n    sameSite: \"lax\",\r\n    maxAge: 60 * 60 * 24 * 7, // 7 days\r\n  })\r\n  return token\r\n}\r\n\r\nexport async function clearSession() {\r\n  const cookieStore = await cookies()\r\n  cookieStore.delete(\"auth-token\")\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;;;;AAEA,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE3D,eAAe,aAAa,QAAQ;IACzC,OAAO,4IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAQ,EAAE,cAAc;IAC3D,OAAO,4IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,eAAe,YAAY,OAAO;IACvC,OAAO,IAAI,gKAAO,CAAC,SAAS,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAAG,iBAAiB,CAAC,MAAM,IAAI,CAAC;AAChG;AAEO,eAAe,YAAY,KAAK;IACrC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,oKAAS,EAAC,OAAO;QAC3C,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,eAAe;IAC7C,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,YAAY;AACrB;AAEO,eAAe,WAAW,MAAM,EAAE,KAAK;IAC5C,MAAM,QAAQ,MAAM,YAAY;QAAE;QAAQ;IAAM;IAChD,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,GAAG,CAAC,cAAc,OAAO;QACnC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;IACzB;IACA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0IAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/robin/OneDrive/Desktop/colorcode/v0-ai-social-media-app/components/profile-setup.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/profile-setup.jsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/profile-setup.jsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAgS,GAC7T,8DACA","ignoreList":[0]}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/robin/OneDrive/Desktop/colorcode/v0-ai-social-media-app/components/profile-setup.jsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/profile-setup.jsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/profile-setup.jsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA4Q,GACzS,0CACA","ignoreList":[0]}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/robin/OneDrive/Desktop/colorcode/v0-ai-social-media-app/app/profile/setup/page.js"],"sourcesContent":["import { redirect } from \"next/navigation\"\r\nimport { getSession } from \"@/lib/auth\"\r\nimport ProfileSetup from \"@/components/profile-setup\"\r\n\r\nexport const metadata = {\r\n  title: \"Setup Profile - Colorcode\",\r\n  description: \"Complete your Colorcode profile\",\r\n}\r\n\r\nexport default async function ProfileSetupPage() {\r\n  const session = await getSession()\r\n\r\n  if (!session) {\r\n    redirect(\"/login\")\r\n  }\r\n\r\n  return <ProfileSetup />\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAAA;AAAA;AACA;AACA;;;;;AAEO,MAAM,WAAW;IACtB,OAAO;IACP,aAAa;AACf;AAEe,eAAe;IAC5B,MAAM,UAAU,MAAM,IAAA,yHAAU;IAEhC,IAAI,CAAC,SAAS;QACZ,IAAA,iMAAQ,EAAC;IACX;IAEA,qBAAO,8OAAC,0IAAY;;;;;AACtB"}}]
}