{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/robin/OneDrive/Desktop/colorcode/v0-ai-social-media-app/lib/auth.js"],"sourcesContent":["import { SignJWT, jwtVerify } from \"jose\"\r\nimport { cookies } from \"next/headers\"\r\nimport bcrypt from \"bcryptjs\"\r\n\r\nconst secret = new TextEncoder().encode(process.env.JWT_SECRET || \"colorcode-secret-key-2024\")\r\n\r\nexport async function hashPassword(password) {\r\n  return bcrypt.hash(password, 12)\r\n}\r\n\r\nexport async function verifyPassword(password, hashedPassword) {\r\n  return bcrypt.compare(password, hashedPassword)\r\n}\r\n\r\nexport async function createToken(payload) {\r\n  return new SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setExpirationTime(\"7d\").sign(secret)\r\n}\r\n\r\nexport async function verifyToken(token) {\r\n  try {\r\n    const { payload } = await jwtVerify(token, secret)\r\n    return payload\r\n  } catch {\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getSession() {\r\n  const cookieStore = await cookies()\r\n  const token = cookieStore.get(\"auth-token\")?.value\r\n  if (!token) return null\r\n  return verifyToken(token)\r\n}\r\n\r\nexport async function setSession(userId, email) {\r\n  const token = await createToken({ userId, email })\r\n  const cookieStore = await cookies()\r\n  cookieStore.set(\"auth-token\", token, {\r\n    httpOnly: true,\r\n    secure: process.env.NODE_ENV === \"production\",\r\n    sameSite: \"lax\",\r\n    maxAge: 60 * 60 * 24 * 7, // 7 days\r\n  })\r\n  return token\r\n}\r\n\r\nexport async function clearSession() {\r\n  const cookieStore = await cookies()\r\n  cookieStore.delete(\"auth-token\")\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;;;;AAEA,MAAM,SAAS,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE3D,eAAe,aAAa,QAAQ;IACzC,OAAO,8IAAM,CAAC,IAAI,CAAC,UAAU;AAC/B;AAEO,eAAe,eAAe,QAAQ,EAAE,cAAc;IAC3D,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AAClC;AAEO,eAAe,YAAY,OAAO;IACvC,OAAO,IAAI,kKAAO,CAAC,SAAS,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAAG,iBAAiB,CAAC,MAAM,IAAI,CAAC;AAChG;AAEO,eAAe,YAAY,KAAK;IACrC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO;QAC3C,OAAO;IACT,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,QAAQ,YAAY,GAAG,CAAC,eAAe;IAC7C,IAAI,CAAC,OAAO,OAAO;IACnB,OAAO,YAAY;AACrB;AAEO,eAAe,WAAW,MAAM,EAAE,KAAK;IAC5C,MAAM,QAAQ,MAAM,YAAY;QAAE;QAAQ;IAAM;IAChD,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,GAAG,CAAC,cAAc,OAAO;QACnC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;IACzB;IACA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB"}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/robin/OneDrive/Desktop/colorcode/v0-ai-social-media-app/lib/cloudinary.js"],"sourcesContent":["import { v2 as cloudinary } from \"cloudinary\"\r\n\r\nlet isConfigured = false\r\n\r\nfunction configureCloudinary() {\r\n  if (!isConfigured) {\r\n    cloudinary.config({\r\n      cloud_name: process.env.CLOUDINARY_CLOUD_NAME,\r\n      api_key: process.env.CLOUDINARY_API_KEY,\r\n      api_secret: process.env.CLOUDINARY_API_SECRET,\r\n    })\r\n    isConfigured = true\r\n  }\r\n  return cloudinary\r\n}\r\n\r\nexport async function uploadImageFromUrl(imageUrl, folder = \"colorcode\") {\r\n  const cloud = configureCloudinary()\r\n\r\n  try {\r\n    const result = await cloud.uploader.upload(imageUrl, {\r\n      folder,\r\n      resource_type: \"image\",\r\n      transformation: [{ quality: \"auto:best\" }, { fetch_format: \"auto\" }],\r\n    })\r\n\r\n    return {\r\n      success: true,\r\n      url: result.secure_url,\r\n      publicId: result.public_id,\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Cloudinary upload error:\", error)\r\n    return {\r\n      success: false,\r\n      error: error.message,\r\n    }\r\n  }\r\n}\r\n\r\nexport async function deleteImage(publicId) {\r\n  const cloud = configureCloudinary()\r\n\r\n  try {\r\n    await cloud.uploader.destroy(publicId)\r\n    return { success: true }\r\n  } catch (error) {\r\n    console.error(\"Cloudinary delete error:\", error)\r\n    return { success: false, error: error.message }\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,IAAI,eAAe;AAEnB,SAAS;IACP,IAAI,CAAC,cAAc;QACjB,gJAAU,CAAC,MAAM,CAAC;YAChB,YAAY,QAAQ,GAAG,CAAC,qBAAqB;YAC7C,SAAS,QAAQ,GAAG,CAAC,kBAAkB;YACvC,YAAY,QAAQ,GAAG,CAAC,qBAAqB;QAC/C;QACA,eAAe;IACjB;IACA,OAAO,gJAAU;AACnB;AAEO,eAAe,mBAAmB,QAAQ,EAAE,SAAS,WAAW;IACrE,MAAM,QAAQ;IAEd,IAAI;QACF,MAAM,SAAS,MAAM,MAAM,QAAQ,CAAC,MAAM,CAAC,UAAU;YACnD;YACA,eAAe;YACf,gBAAgB;gBAAC;oBAAE,SAAS;gBAAY;gBAAG;oBAAE,cAAc;gBAAO;aAAE;QACtE;QAEA,OAAO;YACL,SAAS;YACT,KAAK,OAAO,UAAU;YACtB,UAAU,OAAO,SAAS;QAC5B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;YACL,SAAS;YACT,OAAO,MAAM,OAAO;QACtB;IACF;AACF;AAEO,eAAe,YAAY,QAAQ;IACxC,MAAM,QAAQ;IAEd,IAAI;QACF,MAAM,MAAM,QAAQ,CAAC,OAAO,CAAC;QAC7B,OAAO;YAAE,SAAS;QAAK;IACzB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC;IAChD;AACF"}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/robin/OneDrive/Desktop/colorcode/v0-ai-social-media-app/app/api/ai/generate-image/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\"\r\nimport { getSession } from \"@/lib/auth\"\r\nimport OpenAI from \"openai\"\r\nimport { uploadImageFromUrl } from \"@/lib/cloudinary\"\r\n\r\nfunction getOpenAI() {\r\n  return new OpenAI({\r\n    apiKey: process.env.OPENAI_API_KEY,\r\n  })\r\n}\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    const session = await getSession()\r\n    if (!session) {\r\n      return NextResponse.json({ success: false, error: \"Unauthorized\" }, { status: 401 })\r\n    }\r\n\r\n    const { prompt } = await request.json()\r\n\r\n    if (!prompt) {\r\n      return NextResponse.json({ success: false, error: \"Prompt is required\" }, { status: 400 })\r\n    }\r\n\r\n    // Enhance prompt for better image generation\r\n    const enhancedPrompt = `Create a high-quality, visually stunning image: ${prompt}. Style: photorealistic, vibrant colors, professional lighting, high resolution.`\r\n\r\n    const openai = getOpenAI()\r\n\r\n    const response = await openai.images.generate({\r\n      model: \"dall-e-3\",\r\n      prompt: enhancedPrompt,\r\n      n: 1,\r\n      size: \"1024x1024\",\r\n      quality: \"standard\",\r\n    })\r\n\r\n    const tempImageUrl = response.data[0].url\r\n\r\n    let finalImageUrl = tempImageUrl\r\n\r\n    if (process.env.CLOUDINARY_CLOUD_NAME && process.env.CLOUDINARY_API_KEY && process.env.CLOUDINARY_API_SECRET) {\r\n      const uploadResult = await uploadImageFromUrl(tempImageUrl, \"colorcode/posts\")\r\n\r\n      if (uploadResult.success) {\r\n        finalImageUrl = uploadResult.url\r\n      } else {\r\n        console.error(\"Cloudinary upload failed, using temp URL:\", uploadResult.error)\r\n      }\r\n    }\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      imageUrl: finalImageUrl,\r\n      revisedPrompt: response.data[0].revised_prompt,\r\n    })\r\n  } catch (error) {\r\n    console.error(\"Image generation error:\", error)\r\n    return NextResponse.json({ success: false, error: error.message || \"Failed to generate image\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;AACA;;;;;AAEA,SAAS;IACP,OAAO,IAAI,mLAAM,CAAC;QAChB,QAAQ,QAAQ,GAAG,CAAC,cAAc;IACpC;AACF;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,UAAU,MAAM,IAAA,2HAAU;QAChC,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpF;QAEA,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;QAErC,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAAqB,GAAG;gBAAE,QAAQ;YAAI;QAC1F;QAEA,6CAA6C;QAC7C,MAAM,iBAAiB,CAAC,gDAAgD,EAAE,OAAO,gFAAgF,CAAC;QAElK,MAAM,SAAS;QAEf,MAAM,WAAW,MAAM,OAAO,MAAM,CAAC,QAAQ,CAAC;YAC5C,OAAO;YACP,QAAQ;YACR,GAAG;YACH,MAAM;YACN,SAAS;QACX;QAEA,MAAM,eAAe,SAAS,IAAI,CAAC,EAAE,CAAC,GAAG;QAEzC,IAAI,gBAAgB;QAEpB,IAAI,QAAQ,GAAG,CAAC,qBAAqB,IAAI,QAAQ,GAAG,CAAC,kBAAkB,IAAI,QAAQ,GAAG,CAAC,qBAAqB,EAAE;YAC5G,MAAM,eAAe,MAAM,IAAA,yIAAkB,EAAC,cAAc;YAE5D,IAAI,aAAa,OAAO,EAAE;gBACxB,gBAAgB,aAAa,GAAG;YAClC,OAAO;gBACL,QAAQ,KAAK,CAAC,6CAA6C,aAAa,KAAK;YAC/E;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,UAAU;YACV,eAAe,SAAS,IAAI,CAAC,EAAE,CAAC,cAAc;QAChD;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO,IAAI;QAA2B,GAAG;YAAE,QAAQ;QAAI;IACjH;AACF"}}]
}